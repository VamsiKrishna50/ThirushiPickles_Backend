{"version":3,"file":"static/js/600.a373c162.chunk.js","mappings":"+MAOA,MA0DA,EA1DuBA,KACrB,MAAOC,IAAgBC,EAAAA,EAAAA,MACjBC,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,MACXC,GAAeC,EAAAA,EAAAA,SAAO,GA+C5B,OA7CAC,EAAAA,EAAAA,WAAU,KACR,GAAIF,EAAaG,QAAS,OAE1B,MAAMC,EAAQV,EAAaW,IAAI,SAE/B,GAAID,EAAO,CACTJ,EAAaG,SAAU,EAEvBG,aAAaC,QAAQ,QAASH,GAC9BI,EAAAA,EAAMC,SAASC,QAAQC,OAAsB,cAAC,UAAAC,OAAaR,GAG3D,IACE,MACMS,EADYT,EAAMU,MAAM,KAAK,GACVC,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KACpDC,EAAcC,mBAClBC,KAAKL,GACFC,MAAM,IACNK,IAAKC,GAAM,KAAO,KAAOA,EAAEC,WAAW,GAAGC,SAAS,KAAKC,OAAO,IAC9DC,KAAK,KAKJC,EAAO,CACXC,SAHcC,KAAKC,MAAMZ,GAGPa,IAClBC,KAAM,YAGRhC,GAASiC,EAAAA,EAAAA,IAAa,CAAE3B,QAAOqB,UAE/B7B,EAAS,YAAa,CAAEmB,SAAS,GAEnC,CAEA,MAAOiB,GACLC,QAAQD,MAAM,gCAAiCA,GAC/CpC,EAAS,SAAU,CAAEmB,SAAS,GAChC,CAEF,MACEnB,EAAS,SAAU,CAAEmB,SAAS,KAE/B,KAGDmB,EAAAA,EAAAA,KAACC,EAAAA,EAAG,CAACC,QAAQ,OAAOC,eAAe,SAASC,WAAW,SAASC,UAAU,QAAOC,UAC/EN,EAAAA,EAAAA,KAACO,EAAAA,EAAgB,M","sources":["pages/OAuth2Redirect.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport { CircularProgress, Box } from '@mui/material';\r\nimport { loginSuccess } from '../store/slices/authSlice';\r\nimport axios from 'axios';\r\n\r\nconst OAuth2Redirect = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n  const hasProcessed = useRef(false);\r\n\r\n  useEffect(() => {\r\n    if (hasProcessed.current) return;\r\n    \r\n    const token = searchParams.get('token');\r\n    \r\n    if (token) {\r\n      hasProcessed.current = true;\r\n      \r\n      localStorage.setItem('token', token);\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n      \r\n      // Decode JWT to get user info\r\n      try {\r\n        const base64Url = token.split('.')[1];\r\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n        const jsonPayload = decodeURIComponent(\r\n          atob(base64)\r\n            .split('')\r\n            .map((c) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\r\n            .join('')\r\n        );\r\n        \r\n        const payload = JSON.parse(jsonPayload);\r\n        \r\n        const user = {\r\n          username: payload.sub,\r\n          role: 'CUSTOMER',\r\n        };\r\n        \r\n        dispatch(loginSuccess({ token, user }));\r\n        \r\n        navigate('/customer', { replace: true });\r\n\r\n      } \r\n\r\n      catch (error) {\r\n        console.error('Error processing OAuth token:', error);\r\n        navigate('/login', { replace: true });\r\n      }\r\n      \r\n    } else {\r\n      navigate('/login', { replace: true });\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"100vh\">\r\n      <CircularProgress />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default OAuth2Redirect;"],"names":["OAuth2Redirect","searchParams","useSearchParams","navigate","useNavigate","dispatch","useDispatch","hasProcessed","useRef","useEffect","current","token","get","localStorage","setItem","axios","defaults","headers","common","concat","base64","split","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","user","username","JSON","parse","sub","role","loginSuccess","error","console","_jsx","Box","display","justifyContent","alignItems","minHeight","children","CircularProgress"],"ignoreList":[],"sourceRoot":""}